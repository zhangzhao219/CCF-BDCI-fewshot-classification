expand_train_cur_best.json:

结果文件：result_2022-10-20-02-42-28.csv (test F1 = 0.59952852320)

产生结果文件的实验配置：(chinese-macbert-base, expand_train.json, batch=12，epoch=40 (early stop), gpu=2,3, lr=2e-5, seed=42, split_test_ratio=0.2, dropout=0.3) , percentile = 20, fix_thresh = 0.70


2022/11/07 18:40:53 [INFO] main.93 Log is ready!
2022/11/07 18:40:53 [INFO] main.94 Namespace(K=1, awp=-1, batch=12, bert='pretrained/hfl/chinese-macbert-base', board=True, cb=False, cbntr=False, checkpoint=20, data_file='expand_train.json', data_folder_dir='fewshot', datetime='2022_11_07_18_40_47', db=False, dbfl=False, dropout=0.3, early_stop=20, ema=0.0, en=False, epoch=40, feature_layer=4, fgm=False, fl=False, freeze=0, gpu=['2', '3'], label=36, load=False, load_pt=None, lr=2e-05, mixif=False, model='model1', ntrfl=False, pgd=3, predict=False, predict_with_score=False, rdrop=0.0, rfl=False, save=True, sce=False, seed=42, split_test_ratio=0.2, swa=False, test=False, train=True, warmup=0.0)
2022/11/07 18:40:53 [INFO] main.101 Tensorboard is ready!
2022/11/07 18:40:53 [INFO] main.105 GPU:2,3
2022/11/07 18:40:53 [INFO] main.116 Seed:42
2022/11/07 18:40:54 [INFO] main.147 Read data: ./data/fewshot/expand_train.json
2022/11/07 18:41:01 [INFO] main.340 Start Training 0!
2022/11/07 19:11:04 [INFO] main.453 Train Epoch = 1 Loss:111.557 Metrics:{'F1score': 0.822633, 'Precision': 0.852679, 'Recall': 0.817893}
2022/11/07 19:11:28 [INFO] main.464 Eval Epoch = 1 Metrics:{'F1score': 0.797719, 'Precision': 0.842925, 'Recall': 0.793923}
2022/11/07 19:11:30 [INFO] main.469 checkpoint_0_0_epoch.pt Saved!
2022/11/07 19:11:30 [INFO] main.472 Test metrics:0.797719 > max_metric!
2022/11/07 19:11:31 [INFO] main.481 Best Model Saved!
2022/11/07 19:41:18 [INFO] main.453 Train Epoch = 2 Loss:37.5234 Metrics:{'F1score': 0.894459, 'Precision': 0.901989, 'Recall': 0.891708}
2022/11/07 19:41:42 [INFO] main.464 Eval Epoch = 2 Metrics:{'F1score': 0.859777, 'Precision': 0.880586, 'Recall': 0.854326}
2022/11/07 19:41:42 [INFO] main.472 Test metrics:0.859777 > max_metric!
2022/11/07 19:41:43 [INFO] main.481 Best Model Saved!
2022/11/07 20:11:32 [INFO] main.453 Train Epoch = 3 Loss:25.0709 Metrics:{'F1score': 0.934214, 'Precision': 0.947424, 'Recall': 0.931778}
2022/11/07 20:11:56 [INFO] main.464 Eval Epoch = 3 Metrics:{'F1score': 0.884402, 'Precision': 0.892011, 'Recall': 0.881382}
2022/11/07 20:11:56 [INFO] main.472 Test metrics:0.884402 > max_metric!
2022/11/07 20:11:57 [INFO] main.481 Best Model Saved!
2022/11/07 20:41:45 [INFO] main.453 Train Epoch = 4 Loss:17.7019 Metrics:{'F1score': 0.946015, 'Precision': 0.947054, 'Recall': 0.945288}
2022/11/07 20:42:09 [INFO] main.464 Eval Epoch = 4 Metrics:{'F1score': 0.914534, 'Precision': 0.921851, 'Recall': 0.910162}
2022/11/07 20:42:09 [INFO] main.472 Test metrics:0.914534 > max_metric!
2022/11/07 20:42:10 [INFO] main.481 Best Model Saved!
2022/11/07 21:11:58 [INFO] main.453 Train Epoch = 5 Loss:14.5773 Metrics:{'F1score': 0.933299, 'Precision': 0.956065, 'Recall': 0.932378}
2022/11/07 21:12:22 [INFO] main.464 Eval Epoch = 5 Metrics:{'F1score': 0.883147, 'Precision': 0.896437, 'Recall': 0.876113}
2022/11/07 21:42:13 [INFO] main.453 Train Epoch = 6 Loss:11.4122 Metrics:{'F1score': 0.961428, 'Precision': 0.96313, 'Recall': 0.960084}
2022/11/07 21:42:37 [INFO] main.464 Eval Epoch = 6 Metrics:{'F1score': 0.922115, 'Precision': 0.928093, 'Recall': 0.918515}
2022/11/07 21:42:37 [INFO] main.472 Test metrics:0.922115 > max_metric!
2022/11/07 21:42:39 [INFO] main.481 Best Model Saved!
2022/11/07 22:12:34 [INFO] main.453 Train Epoch = 7 Loss:9.01514 Metrics:{'F1score': 0.962336, 'Precision': 0.984726, 'Recall': 0.956511}
2022/11/07 22:12:59 [INFO] main.464 Eval Epoch = 7 Metrics:{'F1score': 0.897455, 'Precision': 0.909985, 'Recall': 0.893661}
2022/11/07 22:42:49 [INFO] main.453 Train Epoch = 8 Loss:8.0904 Metrics:{'F1score': 0.976314, 'Precision': 0.989246, 'Recall': 0.970985}
2022/11/07 22:43:12 [INFO] main.464 Eval Epoch = 8 Metrics:{'F1score': 0.937392, 'Precision': 0.943544, 'Recall': 0.934787}
2022/11/07 22:43:12 [INFO] main.472 Test metrics:0.937392 > max_metric!
2022/11/07 22:43:14 [INFO] main.481 Best Model Saved!
2022/11/07 23:13:02 [INFO] main.453 Train Epoch = 9 Loss:6.68202 Metrics:{'F1score': 0.962507, 'Precision': 0.969174, 'Recall': 0.967889}
2022/11/07 23:13:27 [INFO] main.464 Eval Epoch = 9 Metrics:{'F1score': 0.921433, 'Precision': 0.924735, 'Recall': 0.930509}
2022/11/07 23:43:16 [INFO] main.453 Train Epoch = 10 Loss:6.11302 Metrics:{'F1score': 0.973113, 'Precision': 0.985969, 'Recall': 0.967972}
2022/11/07 23:43:40 [INFO] main.464 Eval Epoch = 10 Metrics:{'F1score': 0.901277, 'Precision': 0.912378, 'Recall': 0.89982}
2022/11/08 00:13:25 [INFO] main.453 Train Epoch = 11 Loss:5.52032 Metrics:{'F1score': 0.970322, 'Precision': 0.97523, 'Recall': 0.967005}
2022/11/08 00:13:49 [INFO] main.464 Eval Epoch = 11 Metrics:{'F1score': 0.881034, 'Precision': 0.895629, 'Recall': 0.879149}
2022/11/08 00:43:38 [INFO] main.453 Train Epoch = 12 Loss:4.91816 Metrics:{'F1score': 0.98029, 'Precision': 0.985177, 'Recall': 0.978531}
2022/11/08 00:44:02 [INFO] main.464 Eval Epoch = 12 Metrics:{'F1score': 0.927826, 'Precision': 0.92875, 'Recall': 0.932581}
2022/11/08 01:13:51 [INFO] main.453 Train Epoch = 13 Loss:4.4178 Metrics:{'F1score': 0.987952, 'Precision': 0.9962, 'Recall': 0.982625}
2022/11/08 01:14:15 [INFO] main.464 Eval Epoch = 13 Metrics:{'F1score': 0.928674, 'Precision': 0.945786, 'Recall': 0.922589}
2022/11/08 01:44:04 [INFO] main.453 Train Epoch = 14 Loss:2.73468 Metrics:{'F1score': 0.988949, 'Precision': 0.996273, 'Recall': 0.984476}
2022/11/08 01:44:28 [INFO] main.464 Eval Epoch = 14 Metrics:{'F1score': 0.939462, 'Precision': 0.950872, 'Recall': 0.933809}
2022/11/08 01:44:28 [INFO] main.472 Test metrics:0.939462 > max_metric!
2022/11/08 01:44:30 [INFO] main.481 Best Model Saved!
2022/11/08 02:14:18 [INFO] main.453 Train Epoch = 15 Loss:3.00683 Metrics:{'F1score': 0.96569, 'Precision': 0.970408, 'Recall': 0.970595}
2022/11/08 02:14:41 [INFO] main.464 Eval Epoch = 15 Metrics:{'F1score': 0.907006, 'Precision': 0.910143, 'Recall': 0.916463}
2022/11/08 02:44:29 [INFO] main.453 Train Epoch = 16 Loss:2.86673 Metrics:{'F1score': 0.98811, 'Precision': 0.995655, 'Recall': 0.983446}
2022/11/08 02:44:53 [INFO] main.464 Eval Epoch = 16 Metrics:{'F1score': 0.936877, 'Precision': 0.947102, 'Recall': 0.932055}
2022/11/08 03:14:40 [INFO] main.453 Train Epoch = 17 Loss:2.58228 Metrics:{'F1score': 0.986419, 'Precision': 0.995682, 'Recall': 0.980111}
2022/11/08 03:15:04 [INFO] main.464 Eval Epoch = 17 Metrics:{'F1score': 0.928951, 'Precision': 0.9485, 'Recall': 0.916752}
2022/11/08 03:44:51 [INFO] main.453 Train Epoch = 18 Loss:2.01903 Metrics:{'F1score': 0.988873, 'Precision': 0.994386, 'Recall': 0.986305}
2022/11/08 03:45:14 [INFO] main.464 Eval Epoch = 18 Metrics:{'F1score': 0.938371, 'Precision': 0.937601, 'Recall': 0.941308}
2022/11/08 04:15:01 [INFO] main.453 Train Epoch = 19 Loss:1.63766 Metrics:{'F1score': 0.991432, 'Precision': 0.998373, 'Recall': 0.987273}
2022/11/08 04:15:24 [INFO] main.464 Eval Epoch = 19 Metrics:{'F1score': 0.950837, 'Precision': 0.963035, 'Recall': 0.94402}
2022/11/08 04:15:24 [INFO] main.472 Test metrics:0.950837 > max_metric!
2022/11/08 04:15:26 [INFO] main.481 Best Model Saved!
2022/11/08 04:45:13 [INFO] main.453 Train Epoch = 20 Loss:1.53647 Metrics:{'F1score': 0.99211, 'Precision': 0.998763, 'Recall': 0.988242}
2022/11/08 04:45:37 [INFO] main.464 Eval Epoch = 20 Metrics:{'F1score': 0.941062, 'Precision': 0.946861, 'Recall': 0.938927}
2022/11/08 05:15:22 [INFO] main.453 Train Epoch = 21 Loss:1.04826 Metrics:{'F1score': 0.992349, 'Precision': 0.999105, 'Recall': 0.988374}
2022/11/08 05:15:46 [INFO] main.464 Eval Epoch = 21 Metrics:{'F1score': 0.948246, 'Precision': 0.96029, 'Recall': 0.9401}
2022/11/08 05:15:48 [INFO] main.469 checkpoint_20_0_epoch.pt Saved!
2022/11/08 05:45:33 [INFO] main.453 Train Epoch = 22 Loss:32.8169 Metrics:{'F1score': 0.995983, 'Precision': 0.998585, 'Recall': 0.994009}
2022/11/08 05:45:56 [INFO] main.464 Eval Epoch = 22 Metrics:{'F1score': 0.935692, 'Precision': 0.94024, 'Recall': 0.935181}
2022/11/08 06:15:43 [INFO] main.453 Train Epoch = 23 Loss:1.06034 Metrics:{'F1score': 0.996118, 'Precision': 0.998731, 'Recall': 0.994132}
2022/11/08 06:16:06 [INFO] main.464 Eval Epoch = 23 Metrics:{'F1score': 0.936626, 'Precision': 0.94606, 'Recall': 0.933251}
2022/11/08 06:45:53 [INFO] main.453 Train Epoch = 24 Loss:0.833753 Metrics:{'F1score': 0.99678, 'Precision': 0.999832, 'Recall': 0.994346}
2022/11/08 06:46:16 [INFO] main.464 Eval Epoch = 24 Metrics:{'F1score': 0.938526, 'Precision': 0.94624, 'Recall': 0.932739}
2022/11/08 07:16:02 [INFO] main.453 Train Epoch = 25 Loss:0.793036 Metrics:{'F1score': 0.996478, 'Precision': 0.999268, 'Recall': 0.994312}
2022/11/08 07:16:26 [INFO] main.464 Eval Epoch = 25 Metrics:{'F1score': 0.937917, 'Precision': 0.941169, 'Recall': 0.9372}
2022/11/08 07:46:11 [INFO] main.453 Train Epoch = 26 Loss:0.569192 Metrics:{'F1score': 0.996496, 'Precision': 0.999631, 'Recall': 0.993982}
2022/11/08 07:46:35 [INFO] main.464 Eval Epoch = 26 Metrics:{'F1score': 0.938281, 'Precision': 0.938429, 'Recall': 0.940991}
2022/11/08 08:16:19 [INFO] main.453 Train Epoch = 27 Loss:1.05092 Metrics:{'F1score': 0.996538, 'Precision': 0.999645, 'Recall': 0.994052}
2022/11/08 08:16:43 [INFO] main.464 Eval Epoch = 27 Metrics:{'F1score': 0.932342, 'Precision': 0.939767, 'Recall': 0.930851}
2022/11/08 08:46:32 [INFO] main.453 Train Epoch = 28 Loss:0.531305 Metrics:{'F1score': 0.999915, 'Precision': 0.999852, 'Recall': 0.999978}
2022/11/08 08:46:56 [INFO] main.464 Eval Epoch = 28 Metrics:{'F1score': 0.940544, 'Precision': 0.946046, 'Recall': 0.939132}
2022/11/08 09:16:41 [INFO] main.453 Train Epoch = 29 Loss:0.906821 Metrics:{'F1score': 0.995602, 'Precision': 0.99851, 'Recall': 0.993335}
2022/11/08 09:17:05 [INFO] main.464 Eval Epoch = 29 Metrics:{'F1score': 0.849319, 'Precision': 0.871833, 'Recall': 0.833587}
2022/11/08 09:46:51 [INFO] main.453 Train Epoch = 30 Loss:1.10739 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/08 09:47:16 [INFO] main.464 Eval Epoch = 30 Metrics:{'F1score': 0.902564, 'Precision': 0.906076, 'Recall': 0.905118}
2022/11/08 10:17:39 [INFO] main.453 Train Epoch = 31 Loss:0.495995 Metrics:{'F1score': 0.999514, 'Precision': 0.999326, 'Recall': 0.999707}
2022/11/08 10:18:03 [INFO] main.464 Eval Epoch = 31 Metrics:{'F1score': 0.934047, 'Precision': 0.939273, 'Recall': 0.934313}
2022/11/08 11:00:09 [INFO] main.453 Train Epoch = 32 Loss:0.659802 Metrics:{'F1score': 0.999872, 'Precision': 0.999768, 'Recall': 0.999976}
2022/11/08 11:00:32 [INFO] main.464 Eval Epoch = 32 Metrics:{'F1score': 0.863799, 'Precision': 0.87145, 'Recall': 0.862536}
2022/11/08 11:31:09 [INFO] main.453 Train Epoch = 33 Loss:0.618738 Metrics:{'F1score': 0.999347, 'Precision': 0.998765, 'Recall': 0.999957}
2022/11/08 11:31:32 [INFO] main.464 Eval Epoch = 33 Metrics:{'F1score': 0.897031, 'Precision': 0.89921, 'Recall': 0.902116}
2022/11/08 12:02:00 [INFO] main.453 Train Epoch = 34 Loss:0.487654 Metrics:{'F1score': 0.99986, 'Precision': 0.99995, 'Recall': 0.99977}
2022/11/08 12:02:23 [INFO] main.464 Eval Epoch = 34 Metrics:{'F1score': 0.909168, 'Precision': 0.906996, 'Recall': 0.913045}
2022/11/08 12:32:16 [INFO] main.453 Train Epoch = 35 Loss:0.396351 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/08 12:32:39 [INFO] main.464 Eval Epoch = 35 Metrics:{'F1score': 0.845368, 'Precision': 0.856933, 'Recall': 0.842424}
2022/11/08 13:02:32 [INFO] main.453 Train Epoch = 36 Loss:0.440144 Metrics:{'F1score': 0.999857, 'Precision': 0.999962, 'Recall': 0.999752}
2022/11/08 13:02:55 [INFO] main.464 Eval Epoch = 36 Metrics:{'F1score': 0.893501, 'Precision': 0.900035, 'Recall': 0.891224}
2022/11/08 13:32:49 [INFO] main.453 Train Epoch = 37 Loss:0.45069 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/08 13:33:13 [INFO] main.464 Eval Epoch = 37 Metrics:{'F1score': 0.839467, 'Precision': 0.851377, 'Recall': 0.831477}
2022/11/08 14:03:06 [INFO] main.453 Train Epoch = 38 Loss:0.38704 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/08 14:03:29 [INFO] main.464 Eval Epoch = 38 Metrics:{'F1score': 0.869166, 'Precision': 0.876364, 'Recall': 0.867475}
2022/11/08 14:33:24 [INFO] main.453 Train Epoch = 39 Loss:0.452853 Metrics:{'F1score': 0.998946, 'Precision': 0.999423, 'Recall': 0.998502}
2022/11/08 14:33:47 [INFO] main.464 Eval Epoch = 39 Metrics:{'F1score': 0.850185, 'Precision': 0.865013, 'Recall': 0.840575}
2022/11/08 14:33:47 [INFO] main.485 The Effect of last 20 epochs has not improved! Early Stop!
2022/11/08 14:33:47 [INFO] main.486 Best Metric: 0.950837
2022/11/08 14:33:58 [INFO] main.93 Log is ready!
2022/11/08 14:33:58 [INFO] main.94 Namespace(K=1, awp=-1, batch=64, bert='pretrained/hfl/chinese-macbert-base', board=False, cb=False, cbntr=False, checkpoint=0, data_file='expand_train.json', data_folder_dir='fewshot', datetime='2022_11_07_18_40_47', db=False, dbfl=False, dropout=0.3, early_stop=10, ema=0.0, en=False, epoch=50, feature_layer=4, fgm=False, fl=False, freeze=0, gpu=['2', '3'], label=36, load=False, load_pt=None, lr=2e-05, mixif=False, model='model1', ntrfl=False, pgd=0, predict=False, predict_with_score=False, rdrop=0.0, rfl=False, save=False, sce=False, seed=42, split_test_ratio=0.2, swa=False, test=True, train=False, warmup=0.0)
2022/11/08 14:33:58 [INFO] main.105 GPU:2,3
2022/11/08 14:33:58 [INFO] main.116 Seed:42
2022/11/08 14:33:58 [INFO] main.147 Read data: ./data/fewshot/expand_train.json
2022/11/08 14:33:58 [INFO] main.505 Start evaluate!
2022/11/08 14:34:25 [INFO] main.531 best_0.pt Loaded!
2022/11/08 14:36:30 [INFO] main.568 Metrics for best_0.pt : {'F1score': 0.98362, 'Precision': 0.99117, 'Recall': 0.978137}
2022/11/08 14:36:30 [INFO] main.574 Metrics for all model : {'F1score': 0.98362, 'Precision': 0.99117, 'Recall': 0.978137}
2022/11/08 14:36:35 [INFO] main.93 Log is ready!
2022/11/08 14:36:35 [INFO] main.94 Namespace(K=1, awp=-1, batch=64, bert='pretrained/hfl/chinese-macbert-base', board=False, cb=False, cbntr=False, checkpoint=0, data_file='testA.json', data_folder_dir='fewshot', datetime='2022_11_07_18_40_47', db=False, dbfl=False, dropout=0.3, early_stop=10, ema=0.0, en=False, epoch=50, feature_layer=4, fgm=False, fl=False, freeze=0, gpu=['2', '3'], label=36, load=False, load_pt=None, lr=2e-05, mixif=False, model='model1', ntrfl=False, pgd=0, predict=False, predict_with_score=True, rdrop=0.0, rfl=False, save=False, sce=False, seed=42, split_test_ratio=0.2, swa=False, test=False, train=False, warmup=0.0)
2022/11/08 14:36:35 [INFO] main.105 GPU:2,3
2022/11/08 14:36:35 [INFO] main.116 Seed:42
2022/11/08 14:36:35 [INFO] main.147 Read data: ./data/fewshot/testA.json
2022/11/08 14:36:35 [INFO] main.505 Start evaluate!
2022/11/08 14:37:03 [INFO] main.531 best_0.pt Loaded!
2022/11/08 14:39:39 [INFO] main.588 Predict Finished!
