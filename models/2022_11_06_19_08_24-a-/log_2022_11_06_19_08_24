2022/11/06 19:08:48 [INFO] main.94 Log is ready!
2022/11/06 19:08:48 [INFO] main.95 Namespace(K=3, assignee=False, awp=-1, batch=128, bert='pretrained/nghuyong/ernie-3.0-base-zh', board=True, cb=False, cbntr=False, checkpoint=20, data_file='expand_train_6460_aug_tail.json', data_folder_dir='fewshot', datetime='2022_11_06_19_08_24', db=False, dbfl=False, dropout=0.3, early_stop=10, ema=0.0, en=False, epoch=50, feature_layer=4, fgm=True, fl=False, freeze=0, gpu=['6', '7', '8', '9'], label=36, load=False, load_pt=None, lr=2e-05, mixif=False, model='model1', ntrfl=False, pgd=0, predict=False, predict_with_score=False, rdrop=0.0, rfl=False, save=True, sce=False, seed=42, split_test_ratio=0.2, swa=False, test=False, train=True, warmup=0.0)
2022/11/06 19:08:48 [INFO] main.102 Tensorboard is ready!
2022/11/06 19:08:48 [INFO] main.106 GPU:6,7,8,9
2022/11/06 19:08:48 [INFO] main.117 Seed:42
2022/11/06 19:08:48 [INFO] main.151 Read data: ./data/fewshot/expand_train_6460_aug_tail.json
2022/11/06 19:08:56 [INFO] main.344 Start Training 1!
2022/11/06 19:13:10 [INFO] main.457 Train Epoch = 1 Loss:1.85382 Metrics:{'F1score': 0.370055, 'Precision': 0.478702, 'Recall': 0.386665}
2022/11/06 19:13:25 [INFO] main.468 Eval Epoch = 1 Metrics:{'F1score': 0.349393, 'Precision': 0.430514, 'Recall': 0.36836}
2022/11/06 19:13:27 [INFO] main.473 checkpoint_0_1_epoch.pt Saved!
2022/11/06 19:13:27 [INFO] main.476 Test metrics:0.349393 > max_metric!
2022/11/06 19:13:28 [INFO] main.485 Best Model Saved!
2022/11/06 19:17:19 [INFO] main.457 Train Epoch = 2 Loss:0.929809 Metrics:{'F1score': 0.753493, 'Precision': 0.816023, 'Recall': 0.752363}
2022/11/06 19:17:33 [INFO] main.468 Eval Epoch = 2 Metrics:{'F1score': 0.698541, 'Precision': 0.762347, 'Recall': 0.700676}
2022/11/06 19:17:33 [INFO] main.476 Test metrics:0.698541 > max_metric!
2022/11/06 19:17:34 [INFO] main.485 Best Model Saved!
2022/11/06 19:21:13 [INFO] main.457 Train Epoch = 3 Loss:0.556014 Metrics:{'F1score': 0.924738, 'Precision': 0.959695, 'Recall': 0.913386}
2022/11/06 19:21:28 [INFO] main.468 Eval Epoch = 3 Metrics:{'F1score': 0.844195, 'Precision': 0.882653, 'Recall': 0.844085}
2022/11/06 19:21:28 [INFO] main.476 Test metrics:0.844195 > max_metric!
2022/11/06 19:21:28 [INFO] main.485 Best Model Saved!
2022/11/06 19:25:04 [INFO] main.457 Train Epoch = 4 Loss:0.368329 Metrics:{'F1score': 0.980186, 'Precision': 0.986528, 'Recall': 0.975381}
2022/11/06 19:25:18 [INFO] main.468 Eval Epoch = 4 Metrics:{'F1score': 0.892613, 'Precision': 0.896208, 'Recall': 0.89587}
2022/11/06 19:25:18 [INFO] main.476 Test metrics:0.892613 > max_metric!
2022/11/06 19:25:19 [INFO] main.485 Best Model Saved!
2022/11/06 19:28:54 [INFO] main.457 Train Epoch = 5 Loss:0.258802 Metrics:{'F1score': 0.991106, 'Precision': 0.992928, 'Recall': 0.989697}
2022/11/06 19:29:11 [INFO] main.468 Eval Epoch = 5 Metrics:{'F1score': 0.908232, 'Precision': 0.910149, 'Recall': 0.910759}
2022/11/06 19:29:11 [INFO] main.476 Test metrics:0.908232 > max_metric!
2022/11/06 19:29:13 [INFO] main.485 Best Model Saved!
2022/11/06 19:32:54 [INFO] main.457 Train Epoch = 6 Loss:0.197684 Metrics:{'F1score': 0.996314, 'Precision': 0.996955, 'Recall': 0.995714}
2022/11/06 19:33:08 [INFO] main.468 Eval Epoch = 6 Metrics:{'F1score': 0.910841, 'Precision': 0.905221, 'Recall': 0.918913}
2022/11/06 19:33:08 [INFO] main.476 Test metrics:0.910841 > max_metric!
2022/11/06 19:33:09 [INFO] main.485 Best Model Saved!
2022/11/06 19:36:50 [INFO] main.457 Train Epoch = 7 Loss:0.158015 Metrics:{'F1score': 0.998347, 'Precision': 0.998252, 'Recall': 0.998455}
2022/11/06 19:37:05 [INFO] main.468 Eval Epoch = 7 Metrics:{'F1score': 0.9144, 'Precision': 0.910688, 'Recall': 0.92238}
2022/11/06 19:37:05 [INFO] main.476 Test metrics:0.9144 > max_metric!
2022/11/06 19:37:06 [INFO] main.485 Best Model Saved!
2022/11/06 19:40:41 [INFO] main.457 Train Epoch = 8 Loss:0.131117 Metrics:{'F1score': 0.999533, 'Precision': 0.999325, 'Recall': 0.999745}
2022/11/06 19:40:58 [INFO] main.468 Eval Epoch = 8 Metrics:{'F1score': 0.920006, 'Precision': 0.917868, 'Recall': 0.925278}
2022/11/06 19:40:58 [INFO] main.476 Test metrics:0.920006 > max_metric!
2022/11/06 19:40:59 [INFO] main.485 Best Model Saved!
2022/11/06 19:44:30 [INFO] main.457 Train Epoch = 9 Loss:0.111231 Metrics:{'F1score': 0.999549, 'Precision': 0.999277, 'Recall': 0.999825}
2022/11/06 19:44:45 [INFO] main.468 Eval Epoch = 9 Metrics:{'F1score': 0.914086, 'Precision': 0.906999, 'Recall': 0.925287}
2022/11/06 19:48:35 [INFO] main.457 Train Epoch = 10 Loss:0.0974466 Metrics:{'F1score': 0.999953, 'Precision': 0.99993, 'Recall': 0.999976}
2022/11/06 19:48:49 [INFO] main.468 Eval Epoch = 10 Metrics:{'F1score': 0.923505, 'Precision': 0.92614, 'Recall': 0.924006}
2022/11/06 19:48:49 [INFO] main.476 Test metrics:0.923505 > max_metric!
2022/11/06 19:48:50 [INFO] main.485 Best Model Saved!
2022/11/06 19:52:28 [INFO] main.457 Train Epoch = 11 Loss:0.0857231 Metrics:{'F1score': 0.999667, 'Precision': 0.999416, 'Recall': 0.999921}
2022/11/06 19:52:43 [INFO] main.468 Eval Epoch = 11 Metrics:{'F1score': 0.920124, 'Precision': 0.91587, 'Recall': 0.928238}
2022/11/06 19:56:26 [INFO] main.457 Train Epoch = 12 Loss:0.0753335 Metrics:{'F1score': 0.99984, 'Precision': 0.999695, 'Recall': 0.999986}
2022/11/06 19:56:41 [INFO] main.468 Eval Epoch = 12 Metrics:{'F1score': 0.918838, 'Precision': 0.916323, 'Recall': 0.926033}
2022/11/06 20:00:12 [INFO] main.457 Train Epoch = 13 Loss:0.0678948 Metrics:{'F1score': 0.999784, 'Precision': 0.999765, 'Recall': 0.999804}
2022/11/06 20:00:26 [INFO] main.468 Eval Epoch = 13 Metrics:{'F1score': 0.922013, 'Precision': 0.921738, 'Recall': 0.926356}
2022/11/06 20:03:57 [INFO] main.457 Train Epoch = 14 Loss:0.0622644 Metrics:{'F1score': 0.999785, 'Precision': 0.999622, 'Recall': 0.999948}
2022/11/06 20:04:11 [INFO] main.468 Eval Epoch = 14 Metrics:{'F1score': 0.920076, 'Precision': 0.918295, 'Recall': 0.925697}
2022/11/06 20:07:50 [INFO] main.457 Train Epoch = 15 Loss:0.0551716 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:08:08 [INFO] main.468 Eval Epoch = 15 Metrics:{'F1score': 0.925864, 'Precision': 0.922656, 'Recall': 0.931981}
2022/11/06 20:08:08 [INFO] main.476 Test metrics:0.925864 > max_metric!
2022/11/06 20:08:09 [INFO] main.485 Best Model Saved!
2022/11/06 20:11:47 [INFO] main.457 Train Epoch = 16 Loss:0.0500863 Metrics:{'F1score': 0.999819, 'Precision': 0.999752, 'Recall': 0.999888}
2022/11/06 20:12:02 [INFO] main.468 Eval Epoch = 16 Metrics:{'F1score': 0.92362, 'Precision': 0.919245, 'Recall': 0.931748}
2022/11/06 20:15:33 [INFO] main.457 Train Epoch = 17 Loss:0.046471 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:15:48 [INFO] main.468 Eval Epoch = 17 Metrics:{'F1score': 0.924263, 'Precision': 0.921983, 'Recall': 0.930842}
2022/11/06 20:19:19 [INFO] main.457 Train Epoch = 18 Loss:0.0426182 Metrics:{'F1score': 0.999953, 'Precision': 0.99993, 'Recall': 0.999976}
2022/11/06 20:19:34 [INFO] main.468 Eval Epoch = 18 Metrics:{'F1score': 0.922515, 'Precision': 0.924124, 'Recall': 0.924323}
2022/11/06 20:23:04 [INFO] main.457 Train Epoch = 19 Loss:0.039708 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:23:19 [INFO] main.468 Eval Epoch = 19 Metrics:{'F1score': 0.92079, 'Precision': 0.917517, 'Recall': 0.928443}
2022/11/06 20:26:50 [INFO] main.457 Train Epoch = 20 Loss:0.0362163 Metrics:{'F1score': 0.99992, 'Precision': 0.999866, 'Recall': 0.999974}
2022/11/06 20:27:04 [INFO] main.468 Eval Epoch = 20 Metrics:{'F1score': 0.929239, 'Precision': 0.927351, 'Recall': 0.934907}
2022/11/06 20:27:04 [INFO] main.476 Test metrics:0.929239 > max_metric!
2022/11/06 20:27:05 [INFO] main.485 Best Model Saved!
2022/11/06 20:30:36 [INFO] main.457 Train Epoch = 21 Loss:0.0336397 Metrics:{'F1score': 0.999968, 'Precision': 0.999949, 'Recall': 0.999986}
2022/11/06 20:30:52 [INFO] main.468 Eval Epoch = 21 Metrics:{'F1score': 0.92549, 'Precision': 0.926518, 'Recall': 0.927988}
2022/11/06 20:30:55 [INFO] main.473 checkpoint_20_1_epoch.pt Saved!
2022/11/06 20:34:32 [INFO] main.457 Train Epoch = 22 Loss:0.0313835 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:34:47 [INFO] main.468 Eval Epoch = 22 Metrics:{'F1score': 0.920741, 'Precision': 0.92272, 'Recall': 0.923907}
2022/11/06 20:38:29 [INFO] main.457 Train Epoch = 23 Loss:0.028953 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:38:44 [INFO] main.468 Eval Epoch = 23 Metrics:{'F1score': 0.920661, 'Precision': 0.915142, 'Recall': 0.931226}
2022/11/06 20:42:14 [INFO] main.457 Train Epoch = 24 Loss:0.0286869 Metrics:{'F1score': 0.999963, 'Precision': 0.999939, 'Recall': 0.999986}
2022/11/06 20:42:29 [INFO] main.468 Eval Epoch = 24 Metrics:{'F1score': 0.924422, 'Precision': 0.923927, 'Recall': 0.929097}
2022/11/06 20:46:00 [INFO] main.457 Train Epoch = 25 Loss:0.0254888 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:46:15 [INFO] main.468 Eval Epoch = 25 Metrics:{'F1score': 0.921979, 'Precision': 0.925104, 'Recall': 0.92443}
2022/11/06 20:49:46 [INFO] main.457 Train Epoch = 26 Loss:0.023472 Metrics:{'F1score': 0.999928, 'Precision': 0.999909, 'Recall': 0.999948}
2022/11/06 20:50:01 [INFO] main.468 Eval Epoch = 26 Metrics:{'F1score': 0.923303, 'Precision': 0.922846, 'Recall': 0.927888}
2022/11/06 20:53:32 [INFO] main.457 Train Epoch = 27 Loss:0.0215463 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:53:46 [INFO] main.468 Eval Epoch = 27 Metrics:{'F1score': 0.923483, 'Precision': 0.921144, 'Recall': 0.930048}
2022/11/06 20:57:17 [INFO] main.457 Train Epoch = 28 Loss:0.0205778 Metrics:{'F1score': 1.0, 'Precision': 1.0, 'Recall': 1.0}
2022/11/06 20:57:32 [INFO] main.468 Eval Epoch = 28 Metrics:{'F1score': 0.917499, 'Precision': 0.914785, 'Recall': 0.926159}
2022/11/06 21:01:03 [INFO] main.457 Train Epoch = 29 Loss:0.0193617 Metrics:{'F1score': 0.999732, 'Precision': 0.999652, 'Recall': 0.999814}
2022/11/06 21:01:17 [INFO] main.468 Eval Epoch = 29 Metrics:{'F1score': 0.919996, 'Precision': 0.920995, 'Recall': 0.923637}
2022/11/06 21:04:48 [INFO] main.457 Train Epoch = 30 Loss:0.0182732 Metrics:{'F1score': 0.999818, 'Precision': 0.999765, 'Recall': 0.999872}
2022/11/06 21:05:03 [INFO] main.468 Eval Epoch = 30 Metrics:{'F1score': 0.923002, 'Precision': 0.923156, 'Recall': 0.926494}
2022/11/06 21:05:03 [INFO] main.489 The Effect of last 10 epochs has not improved! Early Stop!
2022/11/06 21:05:03 [INFO] main.490 Best Metric: 0.929239
2022/11/06 21:05:06 [INFO] main.344 Start Training 2!
2022/11/06 21:08:56 [INFO] main.457 Train Epoch = 1 Loss:1.91256 Metrics:{'F1score': 0.31662, 'Precision': 0.350518, 'Recall': 0.338488}
2022/11/06 21:09:11 [INFO] main.468 Eval Epoch = 1 Metrics:{'F1score': 0.305293, 'Precision': 0.359662, 'Recall': 0.324979}
2022/11/06 21:09:13 [INFO] main.473 checkpoint_0_2_epoch.pt Saved!
2022/11/06 21:09:13 [INFO] main.476 Test metrics:0.305293 > max_metric!
2022/11/06 21:09:14 [INFO] main.485 Best Model Saved!
2022/11/06 21:12:46 [INFO] main.457 Train Epoch = 2 Loss:0.977173 Metrics:{'F1score': 0.725324, 'Precision': 0.789122, 'Recall': 0.721383}
2022/11/06 21:13:01 [INFO] main.468 Eval Epoch = 2 Metrics:{'F1score': 0.672711, 'Precision': 0.781964, 'Recall': 0.668593}
2022/11/06 21:13:01 [INFO] main.476 Test metrics:0.672711 > max_metric!
2022/11/06 21:13:02 [INFO] main.485 Best Model Saved!
2022/11/06 21:16:33 [INFO] main.457 Train Epoch = 3 Loss:0.603101 Metrics:{'F1score': 0.899444, 'Precision': 0.939691, 'Recall': 0.890677}
2022/11/06 21:16:48 [INFO] main.468 Eval Epoch = 3 Metrics:{'F1score': 0.865134, 'Precision': 0.938117, 'Recall': 0.847854}
2022/11/06 21:16:48 [INFO] main.476 Test metrics:0.865134 > max_metric!
2022/11/06 21:16:49 [INFO] main.485 Best Model Saved!
2022/11/06 21:20:21 [INFO] main.457 Train Epoch = 4 Loss:0.42212 Metrics:{'F1score': 0.954317, 'Precision': 0.965145, 'Recall': 0.950084}
2022/11/06 21:20:35 [INFO] main.468 Eval Epoch = 4 Metrics:{'F1score': 0.927077, 'Precision': 0.954843, 'Recall': 0.915239}
2022/11/06 21:20:35 [INFO] main.476 Test metrics:0.927077 > max_metric!
2022/11/06 21:20:36 [INFO] main.485 Best Model Saved!
2022/11/06 21:24:07 [INFO] main.457 Train Epoch = 5 Loss:0.30964 Metrics:{'F1score': 0.973801, 'Precision': 0.975273, 'Recall': 0.973374}
2022/11/06 21:24:22 [INFO] main.468 Eval Epoch = 5 Metrics:{'F1score': 0.964711, 'Precision': 0.976644, 'Recall': 0.956893}
2022/11/06 21:24:22 [INFO] main.476 Test metrics:0.964711 > max_metric!
2022/11/06 21:24:23 [INFO] main.485 Best Model Saved!
2022/11/06 21:27:55 [INFO] main.457 Train Epoch = 6 Loss:0.244225 Metrics:{'F1score': 0.980015, 'Precision': 0.980825, 'Recall': 0.979767}
2022/11/06 21:28:09 [INFO] main.468 Eval Epoch = 6 Metrics:{'F1score': 0.971388, 'Precision': 0.981029, 'Recall': 0.964332}
2022/11/06 21:28:09 [INFO] main.476 Test metrics:0.971388 > max_metric!
2022/11/06 21:28:10 [INFO] main.485 Best Model Saved!
2022/11/06 21:31:41 [INFO] main.457 Train Epoch = 7 Loss:0.199194 Metrics:{'F1score': 0.984661, 'Precision': 0.98373, 'Recall': 0.985858}
2022/11/06 21:31:56 [INFO] main.468 Eval Epoch = 7 Metrics:{'F1score': 0.978175, 'Precision': 0.982829, 'Recall': 0.974691}
2022/11/06 21:31:56 [INFO] main.476 Test metrics:0.978175 > max_metric!
2022/11/06 21:31:57 [INFO] main.485 Best Model Saved!
2022/11/06 21:35:28 [INFO] main.457 Train Epoch = 8 Loss:0.16988 Metrics:{'F1score': 0.986391, 'Precision': 0.986701, 'Recall': 0.98632}
2022/11/06 21:35:43 [INFO] main.468 Eval Epoch = 8 Metrics:{'F1score': 0.980813, 'Precision': 0.986448, 'Recall': 0.976113}
2022/11/06 21:35:43 [INFO] main.476 Test metrics:0.980813 > max_metric!
2022/11/06 21:35:44 [INFO] main.485 Best Model Saved!
2022/11/06 21:39:16 [INFO] main.457 Train Epoch = 9 Loss:0.144418 Metrics:{'F1score': 0.988289, 'Precision': 0.98823, 'Recall': 0.988527}
2022/11/06 21:39:31 [INFO] main.468 Eval Epoch = 9 Metrics:{'F1score': 0.985892, 'Precision': 0.98844, 'Recall': 0.983871}
2022/11/06 21:39:31 [INFO] main.476 Test metrics:0.985892 > max_metric!
2022/11/06 21:39:32 [INFO] main.485 Best Model Saved!
2022/11/06 21:43:06 [INFO] main.457 Train Epoch = 10 Loss:0.127293 Metrics:{'F1score': 0.989882, 'Precision': 0.990234, 'Recall': 0.989632}
2022/11/06 21:43:20 [INFO] main.468 Eval Epoch = 10 Metrics:{'F1score': 0.980431, 'Precision': 0.98495, 'Recall': 0.976926}
2022/11/06 21:46:55 [INFO] main.457 Train Epoch = 11 Loss:0.112043 Metrics:{'F1score': 0.991341, 'Precision': 0.991686, 'Recall': 0.991104}
2022/11/06 21:47:10 [INFO] main.468 Eval Epoch = 11 Metrics:{'F1score': 0.981961, 'Precision': 0.987448, 'Recall': 0.977458}
2022/11/06 21:50:46 [INFO] main.457 Train Epoch = 12 Loss:0.10093 Metrics:{'F1score': 0.992419, 'Precision': 0.991837, 'Recall': 0.99304}
2022/11/06 21:51:00 [INFO] main.468 Eval Epoch = 12 Metrics:{'F1score': 0.986317, 'Precision': 0.987041, 'Recall': 0.985898}
2022/11/06 21:51:00 [INFO] main.476 Test metrics:0.986317 > max_metric!
2022/11/06 21:51:01 [INFO] main.485 Best Model Saved!
2022/11/06 21:54:36 [INFO] main.457 Train Epoch = 13 Loss:0.0912901 Metrics:{'F1score': 0.993223, 'Precision': 0.992885, 'Recall': 0.993647}
2022/11/06 21:54:50 [INFO] main.468 Eval Epoch = 13 Metrics:{'F1score': 0.982197, 'Precision': 0.985622, 'Recall': 0.979421}
2022/11/06 21:58:25 [INFO] main.457 Train Epoch = 14 Loss:0.0821894 Metrics:{'F1score': 0.993584, 'Precision': 0.993506, 'Recall': 0.993746}
2022/11/06 21:58:39 [INFO] main.468 Eval Epoch = 14 Metrics:{'F1score': 0.984561, 'Precision': 0.988819, 'Recall': 0.981001}
2022/11/06 22:02:12 [INFO] main.457 Train Epoch = 15 Loss:0.0755762 Metrics:{'F1score': 0.994145, 'Precision': 0.993932, 'Recall': 0.994448}
2022/11/06 22:02:27 [INFO] main.468 Eval Epoch = 15 Metrics:{'F1score': 0.985367, 'Precision': 0.988622, 'Recall': 0.982831}
2022/11/06 22:06:00 [INFO] main.457 Train Epoch = 16 Loss:0.0690444 Metrics:{'F1score': 0.994834, 'Precision': 0.994769, 'Recall': 0.994952}
2022/11/06 22:06:15 [INFO] main.468 Eval Epoch = 16 Metrics:{'F1score': 0.984787, 'Precision': 0.986746, 'Recall': 0.98333}
2022/11/06 22:09:46 [INFO] main.457 Train Epoch = 17 Loss:0.0618288 Metrics:{'F1score': 0.994979, 'Precision': 0.994775, 'Recall': 0.99523}
2022/11/06 22:10:01 [INFO] main.468 Eval Epoch = 17 Metrics:{'F1score': 0.9865, 'Precision': 0.988393, 'Recall': 0.985}
2022/11/06 22:10:01 [INFO] main.476 Test metrics:0.9865 > max_metric!
2022/11/06 22:10:02 [INFO] main.485 Best Model Saved!
2022/11/06 22:13:32 [INFO] main.457 Train Epoch = 18 Loss:0.0606398 Metrics:{'F1score': 0.995126, 'Precision': 0.995066, 'Recall': 0.995229}
2022/11/06 22:13:47 [INFO] main.468 Eval Epoch = 18 Metrics:{'F1score': 0.985403, 'Precision': 0.984402, 'Recall': 0.986769}
2022/11/06 22:17:17 [INFO] main.457 Train Epoch = 19 Loss:0.0543784 Metrics:{'F1score': 0.99582, 'Precision': 0.995743, 'Recall': 0.995928}
2022/11/06 22:17:32 [INFO] main.468 Eval Epoch = 19 Metrics:{'F1score': 0.987747, 'Precision': 0.991217, 'Recall': 0.984693}
2022/11/06 22:17:32 [INFO] main.476 Test metrics:0.987747 > max_metric!
2022/11/06 22:17:33 [INFO] main.485 Best Model Saved!
2022/11/06 22:21:04 [INFO] main.457 Train Epoch = 20 Loss:0.0503665 Metrics:{'F1score': 0.996172, 'Precision': 0.996253, 'Recall': 0.996117}
2022/11/06 22:21:19 [INFO] main.468 Eval Epoch = 20 Metrics:{'F1score': 0.989386, 'Precision': 0.990761, 'Recall': 0.988214}
2022/11/06 22:21:19 [INFO] main.476 Test metrics:0.989386 > max_metric!
2022/11/06 22:21:20 [INFO] main.485 Best Model Saved!
2022/11/06 22:24:50 [INFO] main.457 Train Epoch = 21 Loss:0.0470563 Metrics:{'F1score': 0.996263, 'Precision': 0.996406, 'Recall': 0.996164}
2022/11/06 22:25:05 [INFO] main.468 Eval Epoch = 21 Metrics:{'F1score': 0.984426, 'Precision': 0.985191, 'Recall': 0.984092}
2022/11/06 22:25:07 [INFO] main.473 checkpoint_20_2_epoch.pt Saved!
2022/11/06 22:28:37 [INFO] main.457 Train Epoch = 22 Loss:0.0434854 Metrics:{'F1score': 0.996712, 'Precision': 0.996889, 'Recall': 0.996558}
2022/11/06 22:28:52 [INFO] main.468 Eval Epoch = 22 Metrics:{'F1score': 0.987737, 'Precision': 0.989531, 'Recall': 0.986368}
2022/11/06 22:32:23 [INFO] main.457 Train Epoch = 23 Loss:0.0403602 Metrics:{'F1score': 0.996978, 'Precision': 0.996995, 'Recall': 0.996985}
2022/11/06 22:32:37 [INFO] main.468 Eval Epoch = 23 Metrics:{'F1score': 0.988668, 'Precision': 0.988778, 'Recall': 0.988821}
2022/11/06 22:36:08 [INFO] main.457 Train Epoch = 24 Loss:0.0377271 Metrics:{'F1score': 0.997584, 'Precision': 0.997926, 'Recall': 0.997265}
2022/11/06 22:36:23 [INFO] main.468 Eval Epoch = 24 Metrics:{'F1score': 0.984128, 'Precision': 0.986855, 'Recall': 0.98219}
2022/11/06 22:39:53 [INFO] main.457 Train Epoch = 25 Loss:0.0351553 Metrics:{'F1score': 0.997111, 'Precision': 0.997417, 'Recall': 0.996841}
2022/11/06 22:40:08 [INFO] main.468 Eval Epoch = 25 Metrics:{'F1score': 0.98345, 'Precision': 0.984305, 'Recall': 0.983364}
2022/11/06 22:43:39 [INFO] main.457 Train Epoch = 26 Loss:0.0329385 Metrics:{'F1score': 0.997121, 'Precision': 0.997467, 'Recall': 0.996796}
2022/11/06 22:43:53 [INFO] main.468 Eval Epoch = 26 Metrics:{'F1score': 0.985951, 'Precision': 0.989016, 'Recall': 0.983532}
2022/11/06 22:47:24 [INFO] main.457 Train Epoch = 27 Loss:0.0315455 Metrics:{'F1score': 0.997556, 'Precision': 0.997697, 'Recall': 0.997434}
2022/11/06 22:47:39 [INFO] main.468 Eval Epoch = 27 Metrics:{'F1score': 0.987136, 'Precision': 0.989074, 'Recall': 0.985672}
2022/11/06 22:51:11 [INFO] main.457 Train Epoch = 28 Loss:0.0317281 Metrics:{'F1score': 0.998123, 'Precision': 0.998761, 'Recall': 0.997501}
2022/11/06 22:51:25 [INFO] main.468 Eval Epoch = 28 Metrics:{'F1score': 0.988349, 'Precision': 0.991187, 'Recall': 0.985912}
2022/11/06 22:54:57 [INFO] main.457 Train Epoch = 29 Loss:0.0279215 Metrics:{'F1score': 0.998671, 'Precision': 0.999073, 'Recall': 0.998276}
2022/11/06 22:55:12 [INFO] main.468 Eval Epoch = 29 Metrics:{'F1score': 0.986628, 'Precision': 0.989781, 'Recall': 0.984148}
2022/11/06 22:58:42 [INFO] main.457 Train Epoch = 30 Loss:0.0270681 Metrics:{'F1score': 0.998533, 'Precision': 0.998767, 'Recall': 0.998308}
2022/11/06 22:58:57 [INFO] main.468 Eval Epoch = 30 Metrics:{'F1score': 0.986572, 'Precision': 0.986871, 'Recall': 0.986503}
2022/11/06 22:58:57 [INFO] main.489 The Effect of last 10 epochs has not improved! Early Stop!
2022/11/06 22:58:57 [INFO] main.490 Best Metric: 0.989386
2022/11/06 22:59:02 [INFO] main.344 Start Training 3!
2022/11/06 23:02:54 [INFO] main.457 Train Epoch = 1 Loss:1.95241 Metrics:{'F1score': 0.299156, 'Precision': 0.318443, 'Recall': 0.3357}
2022/11/06 23:03:09 [INFO] main.468 Eval Epoch = 1 Metrics:{'F1score': 0.302004, 'Precision': 0.331115, 'Recall': 0.339123}
2022/11/06 23:03:11 [INFO] main.473 checkpoint_0_3_epoch.pt Saved!
2022/11/06 23:03:11 [INFO] main.476 Test metrics:0.302004 > max_metric!
2022/11/06 23:03:12 [INFO] main.485 Best Model Saved!
2022/11/06 23:06:42 [INFO] main.457 Train Epoch = 2 Loss:1.01449 Metrics:{'F1score': 0.673795, 'Precision': 0.801222, 'Recall': 0.674953}
2022/11/06 23:06:57 [INFO] main.468 Eval Epoch = 2 Metrics:{'F1score': 0.653749, 'Precision': 0.729391, 'Recall': 0.666715}
2022/11/06 23:06:57 [INFO] main.476 Test metrics:0.653749 > max_metric!
2022/11/06 23:06:58 [INFO] main.485 Best Model Saved!
2022/11/06 23:10:28 [INFO] main.457 Train Epoch = 3 Loss:0.638684 Metrics:{'F1score': 0.901281, 'Precision': 0.910821, 'Recall': 0.897159}
2022/11/06 23:10:43 [INFO] main.468 Eval Epoch = 3 Metrics:{'F1score': 0.878924, 'Precision': 0.904946, 'Recall': 0.871853}
2022/11/06 23:10:43 [INFO] main.476 Test metrics:0.878924 > max_metric!
2022/11/06 23:10:44 [INFO] main.485 Best Model Saved!
2022/11/06 23:14:14 [INFO] main.457 Train Epoch = 4 Loss:0.430106 Metrics:{'F1score': 0.937126, 'Precision': 0.960738, 'Recall': 0.940763}
2022/11/06 23:14:29 [INFO] main.468 Eval Epoch = 4 Metrics:{'F1score': 0.91493, 'Precision': 0.925591, 'Recall': 0.915409}
2022/11/06 23:14:29 [INFO] main.476 Test metrics:0.91493 > max_metric!
2022/11/06 23:14:30 [INFO] main.485 Best Model Saved!
2022/11/06 23:18:01 [INFO] main.457 Train Epoch = 5 Loss:0.3181 Metrics:{'F1score': 0.960997, 'Precision': 0.974743, 'Recall': 0.95758}
2022/11/06 23:18:16 [INFO] main.468 Eval Epoch = 5 Metrics:{'F1score': 0.944964, 'Precision': 0.973239, 'Recall': 0.93931}
2022/11/06 23:18:16 [INFO] main.476 Test metrics:0.944964 > max_metric!
2022/11/06 23:18:16 [INFO] main.485 Best Model Saved!
2022/11/06 23:21:47 [INFO] main.457 Train Epoch = 6 Loss:0.249749 Metrics:{'F1score': 0.973092, 'Precision': 0.980843, 'Recall': 0.968989}
2022/11/06 23:22:02 [INFO] main.468 Eval Epoch = 6 Metrics:{'F1score': 0.958333, 'Precision': 0.977839, 'Recall': 0.951086}
2022/11/06 23:22:02 [INFO] main.476 Test metrics:0.958333 > max_metric!
2022/11/06 23:22:03 [INFO] main.485 Best Model Saved!
2022/11/06 23:25:33 [INFO] main.457 Train Epoch = 7 Loss:0.206157 Metrics:{'F1score': 0.9806, 'Precision': 0.981199, 'Recall': 0.980668}
2022/11/06 23:25:48 [INFO] main.468 Eval Epoch = 7 Metrics:{'F1score': 0.965363, 'Precision': 0.976564, 'Recall': 0.961316}
2022/11/06 23:25:48 [INFO] main.476 Test metrics:0.965363 > max_metric!
2022/11/06 23:25:49 [INFO] main.485 Best Model Saved!
2022/11/06 23:29:19 [INFO] main.457 Train Epoch = 8 Loss:0.168224 Metrics:{'F1score': 0.984115, 'Precision': 0.983602, 'Recall': 0.984907}
2022/11/06 23:29:34 [INFO] main.468 Eval Epoch = 8 Metrics:{'F1score': 0.9747, 'Precision': 0.979405, 'Recall': 0.972068}
2022/11/06 23:29:34 [INFO] main.476 Test metrics:0.9747 > max_metric!
2022/11/06 23:29:35 [INFO] main.485 Best Model Saved!
2022/11/06 23:33:06 [INFO] main.457 Train Epoch = 9 Loss:0.146215 Metrics:{'F1score': 0.987446, 'Precision': 0.987704, 'Recall': 0.987413}
2022/11/06 23:33:20 [INFO] main.468 Eval Epoch = 9 Metrics:{'F1score': 0.978464, 'Precision': 0.985647, 'Recall': 0.973}
2022/11/06 23:33:20 [INFO] main.476 Test metrics:0.978464 > max_metric!
2022/11/06 23:33:21 [INFO] main.485 Best Model Saved!
2022/11/06 23:36:51 [INFO] main.457 Train Epoch = 10 Loss:0.128777 Metrics:{'F1score': 0.989245, 'Precision': 0.989286, 'Recall': 0.989321}
2022/11/06 23:37:06 [INFO] main.468 Eval Epoch = 10 Metrics:{'F1score': 0.981425, 'Precision': 0.984803, 'Recall': 0.978492}
2022/11/06 23:37:06 [INFO] main.476 Test metrics:0.981425 > max_metric!
2022/11/06 23:37:07 [INFO] main.485 Best Model Saved!
2022/11/06 23:40:37 [INFO] main.457 Train Epoch = 11 Loss:0.113118 Metrics:{'F1score': 0.991047, 'Precision': 0.990018, 'Recall': 0.992176}
2022/11/06 23:40:52 [INFO] main.468 Eval Epoch = 11 Metrics:{'F1score': 0.984053, 'Precision': 0.985221, 'Recall': 0.983008}
2022/11/06 23:40:52 [INFO] main.476 Test metrics:0.984053 > max_metric!
2022/11/06 23:40:53 [INFO] main.485 Best Model Saved!
2022/11/06 23:44:23 [INFO] main.457 Train Epoch = 12 Loss:0.0996196 Metrics:{'F1score': 0.993113, 'Precision': 0.993015, 'Recall': 0.99329}
2022/11/06 23:44:38 [INFO] main.468 Eval Epoch = 12 Metrics:{'F1score': 0.980748, 'Precision': 0.986264, 'Recall': 0.976302}
2022/11/06 23:48:08 [INFO] main.457 Train Epoch = 13 Loss:0.0891104 Metrics:{'F1score': 0.993166, 'Precision': 0.992784, 'Recall': 0.993603}
2022/11/06 23:48:23 [INFO] main.468 Eval Epoch = 13 Metrics:{'F1score': 0.981937, 'Precision': 0.985367, 'Recall': 0.979198}
2022/11/06 23:51:54 [INFO] main.457 Train Epoch = 14 Loss:0.0851284 Metrics:{'F1score': 0.994198, 'Precision': 0.994649, 'Recall': 0.993826}
2022/11/06 23:52:08 [INFO] main.468 Eval Epoch = 14 Metrics:{'F1score': 0.978972, 'Precision': 0.986126, 'Recall': 0.9749}
2022/11/06 23:55:39 [INFO] main.457 Train Epoch = 15 Loss:0.0737732 Metrics:{'F1score': 0.995041, 'Precision': 0.995389, 'Recall': 0.994728}
2022/11/06 23:55:54 [INFO] main.468 Eval Epoch = 15 Metrics:{'F1score': 0.98124, 'Precision': 0.985365, 'Recall': 0.978828}
2022/11/06 23:59:24 [INFO] main.457 Train Epoch = 16 Loss:0.0686925 Metrics:{'F1score': 0.995616, 'Precision': 0.995734, 'Recall': 0.995531}
2022/11/06 23:59:38 [INFO] main.468 Eval Epoch = 16 Metrics:{'F1score': 0.984976, 'Precision': 0.986975, 'Recall': 0.983578}
2022/11/06 23:59:38 [INFO] main.476 Test metrics:0.984976 > max_metric!
2022/11/06 23:59:39 [INFO] main.485 Best Model Saved!
2022/11/07 00:03:10 [INFO] main.457 Train Epoch = 17 Loss:0.061928 Metrics:{'F1score': 0.99625, 'Precision': 0.996486, 'Recall': 0.996044}
2022/11/07 00:03:25 [INFO] main.468 Eval Epoch = 17 Metrics:{'F1score': 0.984936, 'Precision': 0.985694, 'Recall': 0.984691}
2022/11/07 00:06:55 [INFO] main.457 Train Epoch = 18 Loss:0.0565304 Metrics:{'F1score': 0.996418, 'Precision': 0.996808, 'Recall': 0.996058}
2022/11/07 00:07:10 [INFO] main.468 Eval Epoch = 18 Metrics:{'F1score': 0.979821, 'Precision': 0.986308, 'Recall': 0.975229}
2022/11/07 00:10:40 [INFO] main.457 Train Epoch = 19 Loss:0.0507362 Metrics:{'F1score': 0.996083, 'Precision': 0.996324, 'Recall': 0.995879}
2022/11/07 00:10:55 [INFO] main.468 Eval Epoch = 19 Metrics:{'F1score': 0.975799, 'Precision': 0.984038, 'Recall': 0.969256}
2022/11/07 00:14:25 [INFO] main.457 Train Epoch = 20 Loss:0.0477773 Metrics:{'F1score': 0.997074, 'Precision': 0.997351, 'Recall': 0.996818}
2022/11/07 00:14:40 [INFO] main.468 Eval Epoch = 20 Metrics:{'F1score': 0.98165, 'Precision': 0.982602, 'Recall': 0.981126}
2022/11/07 00:18:11 [INFO] main.457 Train Epoch = 21 Loss:0.0443732 Metrics:{'F1score': 0.997106, 'Precision': 0.997045, 'Recall': 0.997194}
2022/11/07 00:18:25 [INFO] main.468 Eval Epoch = 21 Metrics:{'F1score': 0.981914, 'Precision': 0.983605, 'Recall': 0.981074}
2022/11/07 00:18:27 [INFO] main.473 checkpoint_20_3_epoch.pt Saved!
2022/11/07 00:21:58 [INFO] main.457 Train Epoch = 22 Loss:0.0405155 Metrics:{'F1score': 0.997462, 'Precision': 0.997725, 'Recall': 0.997219}
2022/11/07 00:22:13 [INFO] main.468 Eval Epoch = 22 Metrics:{'F1score': 0.980779, 'Precision': 0.98455, 'Recall': 0.978317}
2022/11/07 00:25:43 [INFO] main.457 Train Epoch = 23 Loss:0.038439 Metrics:{'F1score': 0.997516, 'Precision': 0.997657, 'Recall': 0.997388}
2022/11/07 00:25:58 [INFO] main.468 Eval Epoch = 23 Metrics:{'F1score': 0.981673, 'Precision': 0.986919, 'Recall': 0.977849}
2022/11/07 00:29:29 [INFO] main.457 Train Epoch = 24 Loss:0.0383321 Metrics:{'F1score': 0.997569, 'Precision': 0.997802, 'Recall': 0.997352}
2022/11/07 00:29:43 [INFO] main.468 Eval Epoch = 24 Metrics:{'F1score': 0.982944, 'Precision': 0.988091, 'Recall': 0.979036}
2022/11/07 00:33:14 [INFO] main.457 Train Epoch = 25 Loss:0.0341254 Metrics:{'F1score': 0.997208, 'Precision': 0.997808, 'Recall': 0.996626}
2022/11/07 00:33:28 [INFO] main.468 Eval Epoch = 25 Metrics:{'F1score': 0.980215, 'Precision': 0.984634, 'Recall': 0.976618}
2022/11/07 00:36:59 [INFO] main.457 Train Epoch = 26 Loss:0.0323003 Metrics:{'F1score': 0.997739, 'Precision': 0.998324, 'Recall': 0.997171}
2022/11/07 00:37:14 [INFO] main.468 Eval Epoch = 26 Metrics:{'F1score': 0.982271, 'Precision': 0.987357, 'Recall': 0.977845}
2022/11/07 00:37:14 [INFO] main.489 The Effect of last 10 epochs has not improved! Early Stop!
2022/11/07 00:37:14 [INFO] main.490 Best Metric: 0.984976
2022/11/07 00:37:33 [INFO] main.94 Log is ready!
2022/11/07 00:37:33 [INFO] main.95 Namespace(K=3, assignee=False, awp=-1, batch=256, bert='pretrained/nghuyong/ernie-3.0-base-zh', board=False, cb=False, cbntr=False, checkpoint=0, data_file='expand_train_6460_aug_tail.json', data_folder_dir='fewshot', datetime='2022_11_06_19_08_24', db=False, dbfl=False, dropout=0.3, early_stop=10, ema=0.0, en=False, epoch=50, feature_layer=4, fgm=False, fl=False, freeze=0, gpu=['6', '7', '8', '9'], label=36, load=False, load_pt=None, lr=2e-05, mixif=False, model='model1', ntrfl=False, pgd=0, predict=False, predict_with_score=False, rdrop=0.0, rfl=False, save=False, sce=False, seed=42, split_test_ratio=0.2, swa=False, test=True, train=False, warmup=0.0)
2022/11/07 00:37:33 [INFO] main.106 GPU:6,7,8,9
2022/11/07 00:37:33 [INFO] main.117 Seed:42
2022/11/07 00:37:33 [INFO] main.151 Read data: ./data/fewshot/expand_train_6460_aug_tail.json
2022/11/07 00:37:33 [INFO] main.509 Start evaluate!
2022/11/07 00:38:04 [INFO] main.535 best_1.pt Loaded!
2022/11/07 00:39:03 [INFO] main.572 Metrics for best_1.pt : {'F1score': 0.976106, 'Precision': 0.974409, 'Recall': 0.978292}
2022/11/07 00:39:07 [INFO] main.535 best_2.pt Loaded!
2022/11/07 00:39:54 [INFO] main.572 Metrics for best_2.pt : {'F1score': 0.993937, 'Precision': 0.994403, 'Recall': 0.993498}
2022/11/07 00:39:58 [INFO] main.535 best_3.pt Loaded!
2022/11/07 00:40:44 [INFO] main.572 Metrics for best_3.pt : {'F1score': 0.992109, 'Precision': 0.992754, 'Recall': 0.991514}
2022/11/07 00:40:45 [INFO] main.578 Metrics for all model : {'F1score': 0.996779, 'Precision': 0.996866, 'Recall': 0.996711}
2022/11/07 00:40:58 [INFO] main.94 Log is ready!
2022/11/07 00:40:58 [INFO] main.95 Namespace(K=3, assignee=False, awp=-1, batch=256, bert='pretrained/nghuyong/ernie-3.0-base-zh', board=False, cb=False, cbntr=False, checkpoint=0, data_file='testA.json', data_folder_dir='fewshot', datetime='2022_11_06_19_08_24', db=False, dbfl=False, dropout=0.3, early_stop=10, ema=0.0, en=False, epoch=50, feature_layer=4, fgm=False, fl=False, freeze=0, gpu=['6', '7', '8', '9'], label=36, load=False, load_pt=None, lr=2e-05, mixif=False, model='model1', ntrfl=False, pgd=0, predict=True, predict_with_score=False, rdrop=0.0, rfl=False, save=False, sce=False, seed=42, split_test_ratio=0.2, swa=False, test=False, train=False, warmup=0.0)
2022/11/07 00:40:58 [INFO] main.106 GPU:6,7,8,9
2022/11/07 00:40:58 [INFO] main.117 Seed:42
2022/11/07 00:40:58 [INFO] main.151 Read data: ./data/fewshot/testA.json
2022/11/07 00:40:58 [INFO] main.509 Start evaluate!
2022/11/07 00:41:23 [INFO] main.535 best_1.pt Loaded!
2022/11/07 00:42:30 [INFO] main.535 best_2.pt Loaded!
2022/11/07 00:43:25 [INFO] main.535 best_3.pt Loaded!
2022/11/07 00:44:19 [INFO] main.592 Predict Finished!
